# Babel Fish AI - AI を活用した音声文字起こしおよび翻訳拡張機能

Babel Fish AI は、もともと強力な音声文字起こしを提供するために設計された革新的な Chrome 拡張機能です。OpenAI の Whisper API を用いて、驚異的な精度であなたの声をテキストに変換し、オプションでリアルタイムの自動翻訳もご利用いただけます。Babel Fish AI は、文字起こし専用として利用することも、必要に応じてその場で翻訳を有効にすることもできます。

## 🌟 機能

- **高度な音声文字起こし**
  - お使いのデバイスのマイクを通じて高品質な音声をキャプチャ。
  - OpenAI の Whisper API による正確な文字起こし。
  - 音声の処理とテキストの表示のための多言語対応により、様々な言語の音声入力を文字起こしし、お好みの言語で結果を表示可能。
  - テキストを自動的にアクティブな入力欄に挿入するか、専用のダイアログボックスに表示。

- **統合自動翻訳（オプション）**
  - 必要に応じてアクティブ化できる、様々な言語への即時翻訳。
  - 原文の意味を忠実に反映するための高度な AI モデルを使用して翻訳を実施。
  - 文字起こしのみの利用、または文字起こしと翻訳の組み合わせを自由に選択可能。

- **直感的でカスタマイズ可能なユーザーインターフェース**
  - 柔軟な表示モード：アクティブな入力欄または浮動ダイアログウィンドウ。
  - 色、透明度、表示時間を選択可能なステータスバナー。
  - 録音の開始/停止用ショートカットキー（Ctrl+Shift+1 または Mac では ⌘+Shift+1）。
  - 即座に認識できる、マイクと数字「42」を組み合わせたカスタムアイコン。

- **高度なオプション**
    - 詳細な設定を可能にするエキスパートモード（API の URL、ドメインごとの設定など）。
    - 文字起こしと翻訳のモデルをカスタマイズする機能。
    - **LiteLLM Proxy との互換性：代替の言語モデルを使用し、リクエストの記録を無効化可能。**
    - 複数言語でのインターフェースと音声サポートを提供するための、言語ファイル（_locales）による完全な国際化管理。

## 🌐 対応言語

- アラビア語
- ドイツ語
- 英語
- スペイン語
- フランス語
- ヒンディー語
- イタリア語
- 日本語
- 韓国語
- オランダ語
- ポーランド語
- ポルトガル語
- ルーマニア語
- スウェーデン語
- 中国語

## 🚀 インストール

1.  **ダウンロードとインストール:**
    - GitHub からこのリポジトリをクローンするか、拡張機能のフォルダを手動でダウンロードしてください。
    - Chrome を開き、`chrome://extensions/` にアクセス。
    - 右上の「デベロッパーモード」を有効にする。
    - 「パッケージ化されていない拡張機能を読み込む」をクリックし、Babel Fish AI のフォルダを選択する。

2.  **確認:**
    - 拡張機能がカスタムアイコンとともに Chrome のツールバーに表示されていることを確認してください。

## ⚙️ 設定

1.  **OpenAI API キー:**
    *   拡張機能のアイコンをクリックしてオプションにアクセス。
    *   OpenAI の API キーを入力（[platform.openai.com/account/api-keys](https://platform.openai.com/account/api-keys) で入手可能）。

2.  **オプションのカスタマイズ:**
    *   表示モード（アクティブエリアまたはダイアログボックス）を選択。
    *   ステータスバナーの色、透明度、表示時間を設定。
    *   文字起こし（音声入力）と言語テキストの表示用言語を選択。
    *   必要に応じて翻訳機能を有効または無効にする。

3.  **(オプション) LiteLLM Proxy の利用:**
    *   オプションで「エキスパートモード」を有効にする。
    *   「詳細設定」セクションで、LiteLLM Proxy のインスタンスを指すように、API（Whisper と翻訳）の **両方の URL** を変更する。**両方に同じ基本 URL を使用してください。**
    *   LiteLLM によるリクエスト記録を無効にしたい場合は、「NoLog (LiteLLM 専用)」オプションにチェックを入れる。

## 🚀 LiteLLM Proxy を使った利用

Babel Fish AI は [LiteLLM Proxy](https://litellm.ai/) と互換性があり、OpenAI と互換性のある API を用いて代替の言語モデルを利用することができます。

### 設定

1.  **LiteLLM Proxy をインストールして設定:**
    LiteLLM のサイトに記載の指示に従ってください。
2.  **Babel Fish AI 拡張機能を設定:**
    *   拡張機能のオプション（アイコンを右クリック > オプション）で「エキスパートモード」を有効にする。
    *   「詳細設定」セクションで、LiteLLM Proxy のインスタンスを指すように、API（Whisper と翻訳）の **両方の URL** を変更する（例：`http://localhost:4000/v1/audio/transcriptions` および `http://localhost:4000/v1/chat/completions`）。**両方に同じ基本 URL を使用してください。**
    *   LiteLLM によるリクエスト記録を無効にする場合は、「NoLog (LiteLLM 専用)」オプションにチェックを入れる。

**重要 :** 「NoLog」オプションは LiteLLM Proxy 専用に設計されています。OpenAI 公式 API を使用している場合は **有効にしないでください**。そうしないとエラーが発生し、翻訳が機能しなくなります。

## 🛠️ 技術的な動作

### 拡張機能のアーキテクチャ

この拡張機能は、相互に連携する複数の JavaScript ファイルで構成されています：

*   **`manifest.json`:** 拡張機能の主要な設定ファイル。権限、スクリプト、アクセス可能なリソースなどを定義。マニフェストバージョン 3 を使用し、`activeTab`、`storage`、`commands`、`scripting` の権限を宣言。`content_scripts` はすべての URL に注入され、ドキュメントの読み込み完了後に実行されます。
*   **`background.js`:** バックグラウンドで実行されるサービスワーカー。イベント（アイコンのクリック、ショートカットキー）を管理し、必要に応じて `content script` を注入し、`content script` と通信します。
*   **`content.js`:** ウェブページに注入されるスクリプト。DOM と直接連携し、マイクからの音声をキャプチャ、文字起こしおよび翻訳 API を呼び出し、結果を表示します。
*   **`src/utils/api.js`:** OpenAI の Whisper API を呼び出すための `transcribeAudio` 関数を含む（文字起こし用）。
*   **`src/utils/translation.js`:** OpenAI の GPT API を呼び出すための `translateText` 関数を含む（翻訳用）。
*   **`src/utils/ui.js`:** ユーザーインターフェース（バナー、ダイアログボックス、コピー用ボタン）を管理するユーティリティ関数を含む。
*   **`src/constants.js`:** 設定、状態、アクションなどの定数を定義。
*   **`src/pages/options/`:** 拡張機能のオプションページ用のファイル（HTML、CSS、JavaScript）を含む。

### 文字起こしと翻訳のプロセス

1.  **録音の開始:**
    ユーザーが拡張機能のアイコンをクリックするか、ショートカットキーを使用して録音を開始します。`background script` は、録音開始のために `content script` にメッセージを送信します。
2.  **音声のキャプチャ:**
    `content script` は、`navigator.mediaDevices.getUserMedia` API を利用してマイクにアクセスし、音声を録音します。
3.  **文字起こし:**
    `content script` は、`src/utils/api.js` 内の `transcribeAudio` 関数を使用して、音声を OpenAI の Whisper API に送信します。API は文字起こしされたテキストを返します。
4.  **翻訳（オプション）:**
    翻訳オプションが有効な場合、`content script` は、`src/utils/translation.js` 内の `translateText` 関数を利用して、文字起こしされたテキストを OpenAI の GPT API に送信します。API は翻訳済みのテキストを返します。
5.  **表示:**
    `content script` は、文字起こし（および場合によっては翻訳された）テキストを、ページ上のアクティブな要素（テキストフィールドや編集可能な要素の場合）またはダイアログボックスに表示します。

### 通信

`background script` と `content script` 間の通信は、Chrome のメッセージング API（`chrome.runtime.sendMessage` および `chrome.runtime.onMessage`）を通じて行われます。

### データの保存

拡張機能は、`chrome.storage.sync` を使用して以下を保存します：

*   OpenAI API キー（`apiKey`）。
*   拡張機能の各種オプション（表示、翻訳、バナーの色など）。

### エラーの管理
(キーがない、文字起こしエラーなどの)可能なエラーは、`constants.js` に定義されています。`api.js` と `translation.js` の関数は、API 呼び出し時の潜在的なエラーを処理します。`content.js` は、ページ上部のバナーを通じてユーザーにエラーメッセージを表示します。

## 🛡️ セキュリティとプライバシー

- **データの保護:**
  - API キーは Chrome 内で安全に保存されます。
  - 拡張機能は音声データを保持せず、全ての処理はリアルタイムで行われます。
  - API との通信は HTTPS の安全な接続を通じて行われます。

## 🔧 トラブルシューティング

- **マイクの問題:**
  - Chrome でマイクへのアクセス許可が適切に設定されているか確認してください。
  - 他のアプリケーションが同時にマイクを使用していないことを確認してください。

- **文字起こし/翻訳のエラー:**
  - API キーが有効かつアクティブであることを確認してください。
  - 安定したインターネット接続があることを確認してください。
  - エラー発生時は詳細なログを得るために Chrome のコンソールを確認してください。

## 🤝 貢献

貢献や提案は大歓迎です。貢献するには：
- GitHub の Issues セクションでバグを報告する。
- 改善点や新機能を提案する。
- プルリクエストを送信する。

## 📄 ライセンス

この拡張機能は GNU Affero General Public License v3.0 (AGPL-3.0) の下で配布されています。詳細は LICENSE ファイルを参照してください。

## 💝 サポート

この拡張機能を気に入っていただけた場合は、[PayPal](https://paypal.me/jls) を通じて開発を支援することができます。

---
jls42.org によって情熱と革新をもって開発された Babel Fish AI は、最先端の人工知能によって文字起こしと翻訳を新たな高みへと押し上げます。

**このドキュメントは、o3-mini モデルを使用してフランス語版から日本語に翻訳されました。翻訳プロセスの詳細については、https://gitlab.com/jls42/ai-powered-markdown-translator をご覧ください。**

